<!DOCTYPE html>
<html>
<meta charset="utf-8">
<title>PANCAN-INFO</title>
<head>
    <link rel="shortcut icon" href="https://icgc.org/files/org_sys/pan.png">
    <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script type="text/javascript" src="http://d3js.org/topojson.v1.min.js"></script>
    <script type="text/javascript" src="http://datamaps.github.io/scripts/datamaps.all.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="http://localhost/cgi-bin/styletable">
    <link rel="stylesheet" type="text/css" href="http://bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">
</head>
<style>
		#headere{
		background-color: #7FB5DA;
		
	}
	#inside{
		line-height: 50px;
		font-size:12px;
	}
</style>
<body>
	 <div id="headere">
                <h1 style="float:left;margin-left:10px;font-size:25px;">PANCANCER.INFO</h1>
                <center><div id="inside">
                 <ul class="tab-links">
                                <li><a href="http://ec2-54-91-91-247.compute-1.amazonaws.com/">Sites</a></li>
                                <li><a href="http://ec2-54-91-91-247.compute-1.amazonaws.com/upload.html">Uploads</a></li>
                 </ul>
                 </div></center>
                 </div>
                 <center><h2>Upload/ Download Progress via GNOS</h2>
                <i><p>*Still a work in progress, feedback is welcome!</p></i>
                <p style="font-size:10px;">Projects that are not included are OV-AU, PACA-AU, PAEN-AU, PRAD-CA, GAGA-CN, LICA-FR, ORCA-IN, LINC-JP, BRCA-KR, and all US TCGA projects</p>
                </center>
<div id="fullcontain">
        <div id="center1">
                <div id="tablediv">
                        <div id="table">
                        <table name="x" id="rounded-corner" summary="">
                                <thead>
                                        <tr>
                                        <th scope="col"></th>
                                        <th scope="col"><a href="defiles.txt" title="PBCA-DE, MALY-DE, EOPC-DE">Heidelberg</a></th>
                                        <th scope="col"><a href="camfiles.txt" title="ESAD-UK, BRCA-EU">Cambridge</a></th>
                                        <th scope="col"><a href="hinfiles.txt" title="BRCA-UK, CMDI-UK, BOCA-UK, BRCA-UK">Hinxton</a></th>
                                        <th scope="col"><a href="cafiles.txt" title="PACA-CA">Toronto</a></th>
                                        <th scope="col"><a href="esfiles.txt" title="CLLE-ES">Barcelona</a></th>
                                        <th scope="col"><a href="sgfiles.txt" title="BTCA-SG">Singapore</a></th>
                                        <th scope="col"><a href="krfiles.txt" title="LAML-KR">Seoul</a></th>
                                        <th scope="col"><a href="jpfiles.txt" title="LIRI-JP">Tokyo</a></th>
                                        <th scope="col"><a href="all_files">Total</a></th>
                                        <th scope="col">Percentage</a></th>
                                        </tr>
                                </thead>
				 <tbody>
                                        <tr>
                                                <td><b>Uploaded</b></td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                                        </tr>
                                        <tr>
                                                <td><b>Files Left</b></td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
                                        </tr>
                                        <tr>
                                                <td><b>Total Files</b></td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td></td>
                                        </tr>
                                        <tr>
                                                <td><b>Matched Tumour/Normal Pairs</b></td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td></td>
                                        </tr>
                                </tbody>
				<tfoot>
                                        <tr>
                                                <td colspan="12">*Updates every 2 hours</td>
                                        </tr>
                                </tfoot>
				</table>
			</div><!--table-->
		</div><!--tablediv-->
		<div id="chartdiv">
				<div id="charttop">
                                        <h3 style="margin: 20px;">Percentage of Files Uploaded</h3>
                                        <div id="radio" style="margin-right:25px;">
                                                <input type="radio" name="time" id="hr1" onchange="checkr1()">Hourly
                                                <input type="radio" name="time" id="day1" onchange="checkr1()">Daily
                                                <input type="radio" name="time" id="dkfz1" onchange="checkr1()">DKFZ
                                                <input type="radio" name="time" id="ebi1" onchange="checkr1()">EBI
                                                <input type="radio" name="time" id="bsc1" onchange="checkr1()">BSC
                                                <input type="radio" name="time" id="etri1" onchange="checkr1()">ETRI
                                                <input type="radio" name="time" id="osdc1" onchange="checkr1()">OSDC
                                                <input type="radio" name="time" id="riken1" onchange="checkr1()">RIKEN
                                        </div>
                                </div>
                                <div id ="chartbottom">
                                        <h3 style="margin: 20px;">Number of Files Uploaded</h3>
                                        <div id="radio" style="margin-right:25px;">
                                                <input type="radio" name="time" id="hr2" onchange="checkr2()">Hourly
                                                <input type="radio" name="time" id="day2" onchange="checkr2()">Daily
                                                <input type="radio" name="time" id="dkfz2" onchange="checkr2()">DKFZ
                                                <input type="radio" name="time" id="ebi2" onchange="checkr2()">EBI
                                                <input type="radio" name="time" id="bsc2" onchange="checkr2()">BSC
                                                <input type="radio" name="time" id="etri2" onchange="checkr2()">ETRI
                                                <input type="radio" name="time" id="osdc2" onchange="checkr2()">OSDC
                                                <input type="radio" name="time" id="riken2" onchange="checkr2()">RIKEN
                                        </div>
                                </div>
		</div><!--chartdiv-->
		<script type="text/javascript">
			function charts(data,label,popup,spot,maxnum,num){
			//creates the line chart.
			  var margin = {top: 20, right: 55, bottom: 115, left: 40},
				  width  = 550,
				  height = 200;

			  var x = d3.scale.ordinal()
				  .rangeRoundBands([0, width], .1);

			  var y = d3.scale.linear()
				  .rangeRound([height, 0]);

			  var xAxis = d3.svg.axis()
				  .scale(x)
				  .orient("bottom");

			  var yAxis = d3.svg.axis()
				  .scale(y)
				  .orient("left");

			  var line = d3.svg.line()
				  .interpolate("cardinal")
				  .x(function (d) { return x(d.label) + x.rangeBand() / 2; })
				  .y(function (d) { return y(d.value); });

			  var color = d3.scale.ordinal()
				  .range(["#001c9c","#7F5217","#475003","#9c8305","#d3c47c","#800000","#6C007D","#63AFD0"]);

			  var svg = d3.select("#chart"+spot).append("svg")
				  .attr("id","svg"+num)
				  .attr("width",  width  + margin.left + margin.right)
				  .attr("height", height + margin.top  + margin.bottom)
				  .append("g")
				  .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

			  //reading in the data
			  d3.csv(""+data, function (error, data) {

				var labelVar = 'quarter';
				var varNames = d3.keys(data[0]).filter(function (key) { return key !== labelVar;});
				color.domain(varNames);

				var seriesData = varNames.map(function (name) {
				  return {
					name: name,
					values: data.map(function (d) {
					  return {name: name, label: d[labelVar], value: +d[name]};
					})
				  };
				});

				x.domain(data.map(function (d) { return d.quarter; }));
				
				if (maxnum == 1){
					y.domain([0,1]);
					}
				else {
				y.domain([0,d3.max(seriesData, function (c) { 
					return d3.max(c.values, function (d) { return d.value; });
					})
				  ]);
				}

				svg.append("g")
					.attr("class", "x axis")
					.attr("transform", "translate(0," + height + ")")
					.call(xAxis)
					.selectAll("text")  
				//.call(wrap, x.rangeBand())
					.style("text-anchor", "end")
					.attr("dx", "-.8em")
					.attr("dy", ".15em")
					.attr("transform", function(d) {
						return "rotate(-70)" 
						});

				svg.append("g")
					.attr("class", "y axis")
					.call(yAxis)
					.append("text")
					.attr("transform", "rotate(-90)")
					.attr("y", 6)
					.attr("dy", ".71em")
					.style("text-anchor", "end")
					.text(""+label);

				var series = svg.selectAll(".series")
					.data(seriesData)
					.enter().append("g")
					.attr("class", "series");

				series.append("path")
				  .attr("class", "line")
				  .attr("d", function (d) { return line(d.values); })
				  .style("stroke", function (d) { return color(d.name); })
				  .style("stroke-width", "4px")
				  .style("fill", "none")

				series.selectAll(".point")
				  .data(function (d) { return d.values; })
				  .enter().append("circle")
				   .attr("class", "point")
				   .attr("cx", function (d) { return x(d.label) + x.rangeBand()/2; })
				   .attr("cy", function (d) { return y(d.value); })
				   .attr("r", "5px")
				   .style("fill", function (d) { return color(d.name); })
				   .style("stroke", "grey")
				   .style("stroke-width", "2px")
				   .on("mouseover", function (d) { showPopover.call(this, d); })
				   .on("mouseout",  function (d) { removePopovers(); })

				var legend = svg.selectAll(".legend")
					.data(varNames.slice().reverse())
				  .enter().append("g")
					.attr("class", "legend")
					.attr("transform", function (d, i) { return "translate(55," + i * 20 + ")"; });

				legend.append("rect")
					.attr("x", width - 10)
					.attr("width", 10)
					.attr("height", 10)
					.style("fill", color)
					.style("stroke", "grey");

				legend.append("text")
					.attr("x", width - 12)
					.attr("y", 6)
					.attr("dy", ".35em")
					.style("text-anchor", "end")
					.text(function (d) { return d; });

				//handles the hover aspect
				function removePopovers () {
				  $('.popover').each(function() {
					$(this).remove();
				  }); 
				}

				function showPopover (d) {
				  $(this).popover({
					title: d.name,
					placement: 'auto top',
					container: 'body',
					trigger: 'manual',
					html : true,
					content: function() { 
					  return "Date: " + d.label + 
							 "<br/>"+popup+ ": " + d3.format(",")(d.value ? d.value: d.y1 - d.y0); }
				  });
				  $(this).popover('show')
				}
				
				//rotates the x-axis label
				function wrap(text, width) {
				  text.each(function() {
					var text = d3.select(this),
						words = text.text().split(/\s+/).reverse(),
						word,
						line = [],
						lineNumber = 0,
						lineHeight = 1.1, // ems
						y = text.attr("y"),
						dy = parseFloat(text.attr("dy")),
						tspan = text.text(null).append("tspan").attr("x", 0).attr("y", y).attr("dy", dy + "em");
					while (word = words.pop()) {
					  line.push(word);
					  tspan.text(line.join(" "));
					  if (tspan.node().getComputedTextLength() > width) {
						line.pop();
						tspan.text(line.join(" "));
						line = [word];
						tspan = text.append("tspan").attr("x", 0).attr("y", y).attr("dy", ++lineNumber * lineHeight + dy + "em").text(word);
				  }
				 }
				});
			   }
			  });
		  }
		 
		//checks which data to graph for the proportion chart
		function checkr1(){
        if (document.getElementById("hr1").checked == true){
        d3.select("#svg1").remove();
        charts("ave_data.csv","Percentage Uploaded %","Uploaded %","top",1,1);
        }
        else if (document.getElementById("day1").checked == true){
        d3.select("#svg1").remove();
        charts("ave_daily.csv","Percentage Uploaded %","Uploaded %","top",1,1);
        }
        else if (document.getElementById("dkfz1").checked == true){
        d3.select("#svg1").remove();
        charts("DKFZ_ave_data.csv","Percentage Uploaded %","Uploaded %","top",1,1);
        }
        else if (document.getElementById("ebi1").checked == true){
        d3.select("#svg1").remove();
        charts("EBI_ave_data.csv","Percentage Uploaded %","Uploaded %","top",1,1);
        }
        else if (document.getElementById("bsc1").checked == true){
        d3.select("#svg1").remove();
        charts("BSC_ave_data.csv","Percentage Uploaded %","Uploaded %","top",1,1);
        }
        else if (document.getElementById("etri1").checked == true){
        d3.select("#svg1").remove();
        charts("ETRI_ave_data.csv","Percentage Uploaded %","Uploaded %","top",1,1);
        }
        else if (document.getElementById("osdc1").checked == true){
        d3.select("#svg1").remove();
        charts("OSDC_ave_data.csv","Percentage Uploaded %","Uploaded %","top",1,1);
        }
        else if (document.getElementById("riken1").checked == true){
        d3.select("#svg1").remove();
        charts("RIKEN_ave_data.csv","Percentage Uploaded %","Uploaded %","top",1,1);
        }
        ;
}

		//checks which data to graph for the upload number chart
	    function checkr2(){
        if (document.getElementById("hr2").checked == true){
        d3.select("#svg2").remove();
        charts("up_data.csv","Uploaded","Uploaded","bottom",0,2);
        }
        else if (document.getElementById("day2").checked == true){
        d3.select("#svg2").remove();
        charts("up_daily.csv","Uploaded","Uploaded","bottom",0,2);
        }
        else if (document.getElementById("dkfz2").checked == true){
        d3.select("#svg2").remove();
        charts("DKFZ_up_data.csv","Uploaded","Uploaded","bottom",0,2);
        }
        else if (document.getElementById("ebi2").checked == true){
        d3.select("#svg2").remove();
        charts("EBI_up_data.csv","Uploaded","Uploaded","bottom",0,2);
        }
        else if (document.getElementById("bsc2").checked == true){
        d3.select("#svg2").remove();
        charts("BSC_up_data.csv","Uploaded","Uploaded","bottom",0,2);
        }
        else if (document.getElementById("etri2").checked == true){
        d3.select("#svg2").remove();
        charts("ETRI_up_data.csv","Uploaded","Uploaded","bottom",0,2);
        }
        else if (document.getElementById("osdc2").checked == true){
        d3.select("#svg2").remove();
        charts("OSDC_up_data.csv","Uploaded","Uploaded","bottom",0,2);
        }
        else if (document.getElementById("riken2").checked == true){
        d3.select("#svg2").remove();
        charts("RIKEN_up_data.csv","Uploaded","Uploaded","bottom",0,2);
        }       
        ;
}
			
			//calls function to make the charts
		    charts("ave_data.csv","Proportion Uploaded %","Proportion Uploaded","top",1,1);
		    charts("up_data.csv","Uploaded","Uploaded","bottom",0,2);
			</script>
	</div><!--center1-->
<script type="text/javascript">
      //creates the maps and arcs for all except cambridge
      
      //world with all bubbles
      function whole_world(tab,file,arc){
		  var colors = d3.scale.category10();
		  //basic map config with custom fills, mercator projection
		  var pic = new Datamap({
			  scope: "world",
			  element: document.getElementById(tab),
			  
			  geographyConfig: {
				  popupOnHover: false,
				  highlightOnHover: false,},
			  
			  projection: 'mercator',
			  
			  fills: {
				  defaultFill: "#ABDDA4",
				  red: "#FF0000",
				  blue: "#63AFD0",
				  yellow: "#FFFF00",
				  green: "#00FF00",
				  orange: "90FFFA"}
			})
				  
		  //creates the bubbles
		  var json_data;
		  
		  d3.json(""+file, function(error, json) {
			  json_data = json;
			  pic.bubbles(json_data, {
				 popupTemplate: function(geo, data) {
					 if(data.fillKey !== "blue"){
					  return "<div class='hoverinfo'>"+data.project+"<br/>Uploaded: " + data.uploaded + " Total: " +data.total+ "</div>";	}
					  else{return "<div class='hoverinfo'>"+data.project};
					  }
			  });
		  });
		   
		   //creates the arcs
		   var arc_data1;
			  d3.json(""+arc, function(error, json) {
			  arc_data1 = json;
			   pic.arc(arc_data1,  {strokeWidth: 2, arcSharpness: 0});
			   });
		   
		 
		}
	
	//map for cambridge and hinxton
	function world_uk(tab,filename,arc){
		var zoom = new Datamap({
			element: document.getElementById(tab),
			scope: 'world',
			geographyConfig: {
				popupOnHover: false,
				highlightOnHover: false,},
			setProjection: function(element) {
		
				var projection = d3.geo.mercator()
				.center([1, 52])
				.rotate([4.4, 0])
				.scale(3500)
				.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
		
				var path = d3.geo.path()
				.projection(projection);
		
				return {path: path, projection: projection};
			},
		
			fills: {
				defaultFill: "#ABDDA4",
				red: "#FF0000",
                blue: "#63AFD0",
				yellow: "#FFFF00",
				green: "#00FF00",
				orange: "90FFFA"}
		})

		//creates the bubbles
		var json_data;

		d3.json(""+filename, function(error, json) {
			json_data = json;
			zoom.bubbles(json_data, {
				popupTemplate: function(geo, data) {
					if (data.fillKey !== "blue"){
					return "<div class='hoverinfo'>"+data.name+"<br/>Uploaded: " + data.uploaded + " Total: " +data.total+ "</div>";}
					else {return "<div class='hoverinfo'>"+data.name;};
				}
			});
		});
		
		//creates the arcs
		var arc_data1;
			  d3.json(""+arc, function(error, json) {
			  arc_data1 = json;
			   pic.arc(arc_data1,  {strokeWidth: 2, arcSharpness: 0});
			   });
		

}
</script>
<script type="text/javascript">
	//updates the table
	var table = document.getElementsByName("x");
        var table2 = document.getElementsByName("x1");
        var json_data;
        var json_data2;
        var cell_1 = [];
        var cell_2 = [];
        var cell_3 = [];
        var cell_4 = [];
        var cell_5 = [];
        var cell_6 = [];
        var val_1 = [];
        var val_2 = [];
        var val_3 = [];
        var val_4 = [];
        var val_5 = [];
        var val_6 = [];
        var total_1 = 0;
        var total_2 = 0;
        var total_3 = 0;
        var total_4 = 0;
        var total_5 = 0; 
        var total_6 = 0;
        
        d3.json("table2.json", function(error, json) {
                json_data2 = json;
                for (var i = 1; i < json_data2.length; i++){
                        
                        if (json_data2[i-1].project == current){
                                cell_6[1] = table2[0].rows[i].cells[0];
                                val_6[1] = cell_6[1].firstChild.data;
                                cell_6[1].firstChild.data = ''+json_data2[i].origin;
                                cell_6[1] = table2[0].rows[i].cells[1];
                                val_6[1] = cell_6[1].firstChild.data;
                                cell_6[1].firstChild.data = ''+json_data2[i].project;
                                cell_6[1] = table2[0].rows[i-1].cells[2];
                                val_6[1] = cell_6[1].firstChild.data;
                                cell_6[1].firstChild.data = ''+json_data2[i-1].dest+', '+json_data2[i-2].dest;
                                cell_6[1] = table2[0].rows[i].cells[2];
                                val_6[1] = cell_6[1].firstChild.data;
                                cell_6[1].firstChild.data = ''+json_data2[i].dest;}
                                
                        else if (i == json_data2.length-1 || i == json_data2.length-2){
                                cell_6[1] = table2[0].rows[i].cells[0];
                                val_6[1] = cell_6[1].firstChild.data;
                                cell_6[1].firstChild.data = ''+json_data2[i].origin;
                                cell_6[1] = table2[0].rows[i].cells[1];
                                val_6[1] = cell_6[1].firstChild.data;
                                cell_6[1].firstChild.data = ''+json_data2[i].project;
                                cell_6[1] = table2[0].rows[i].cells[2];
                                val_6[1] = cell_6[1].firstChild.data;
                                cell_6[1].firstChild.data = ''+json_data2[i].dest;}
                        else {
                                cell_6[1] = table2[0].rows[i].cells[0];
                                val_6[1] = cell_6[1].firstChild.data;
                                cell_6[1].firstChild.data = ''+json_data2[i-1].origin;
                                cell_6[1] = table2[0].rows[i].cells[1];
                                val_6[1] = cell_6[1].firstChild.data;
                                cell_6[1].firstChild.data = ''+json_data2[i-1].project;
                                cell_6[1] = table2[0].rows[i].cells[2];
                                val_6[1] = cell_6[1].firstChild.data;
                                cell_6[1].firstChild.data = ''+json_data2[i-1].dest;}
                                
                        var current = json_data2[i-1].project;
                }
                        
        });

	d3.json("bubble_data.json", function(error, json) {
                json_data = json;
                for (var i = 1,j = 0; i < json_data.length/2 + 2, j < json_data.length; i++, j+=2){
                                cell_1[i] = table[0].rows[1].cells[i];
                val_1[i] = cell_1[i].firstChild.data;
                cell_1[i].firstChild.data = ''+json_data[j].uploaded;
                total_1 += json_data[j].uploaded;
                
                cell_3[i] = table[0].rows[3].cells[i];
                val_3[i] = cell_3[i].firstChild.data;
                cell_3[i].firstChild.data = ''+json_data[j].total;
                total_3 += json_data[j].total;
                
                //cell_4[i] = table[0].rows[4].cells[i];
                //val_4[i] = cell_4[i].firstChild.data;
                //cell_4[i].firstChild.data = ''+json_data[j].tumour;
                //total_4 += json_data[j].tumour;
                
                //cell_5[i] = table[0].rows[5].cells[i];
                //val_5[i] = cell_5[i].firstChild.data;
                //cell_5[i].firstChild.data = ''+json_data[j].normal;
                //total_5 += json_data[j].normal;

                cell_6[i] = table[0].rows[4].cells[i];
                val_6[i] = cell_6[i].firstChild.data;
                cell_6[i].firstChild.data = ''+json_data[j].match;
                total_6 += json_data[j].match;
                
                cell_2[i] = table[0].rows[2].cells[i];
                val_2[i] = cell_2[i].firstChild.data;
                var left = json_data[j].total - json_data[j].uploaded;
                cell_2[i].firstChild.data = ''+left;
                total_2 += left;
                }
		
		cell_1[9] = table[0].rows[1].cells[9];
                cell_2[9] = table[0].rows[2].cells[9];
                cell_1[10] = table[0].rows[1].cells[10];
                cell_2[10] = table[0].rows[2].cells[10];
                cell_3[9] = table[0].rows[3].cells[9];
                //cell_4[9] = table[0].rows[4].cells[9];
                //cell_5[9] = table[0].rows[5].cells[9];
                cell_6[9] = table[0].rows[4].cells[9];
                
                val_1[9] = cell_1[9].firstChild.data;
                val_2[9] = cell_1[9].firstChild.data;
                val_1[10] = cell_1[9].firstChild.data;
                val_2[10] = cell_1[9].firstChild.data;
                val_3[9] = cell_1[9].firstChild.data;
                //val_4[9] = cell_1[9].firstChild.data;
                //val_5[9] = cell_1[9].firstChild.data;
                val_6[9] = cell_1[9].firstChild.data;
                
                cell_1[9].firstChild.data = ''+total_1;
                cell_2[9].firstChild.data = ''+total_2;
                cell_3[9].firstChild.data = ''+total_3;
                //cell_4[9].firstChild.data = ''+total_4;
                //cell_5[9].firstChild.data = ''+total_5;
                cell_6[9].firstChild.data = ''+total_6;
                
                var ave1 = 100*(total_1/(total_1+total_2));
                var ave2 = 100*(total_2/(total_1+total_2));
                var all = total_1 + total_2;
                cell_1[10].firstChild.data = ''+total_1+'/'+all+' ('+ave1.toFixed(2)+')';
                cell_2[10].firstChild.data = ''+total_2+'/'+all+' ('+ave2.toFixed(2)+')';               
});

</script>
	<div id="center2">
	<table name="x1" id="rounded-corner" summary="" style="float:left;margin-left:30px;margin-top:5px;">
        <thead>
                                        <tr>
                                        <th scope="col">Origins</th>
                                        <th scope="col">Projects</th>
                                        <th scope="col">Destinations</th>
                                        </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                                <td>Uploaded</td><td>0</td><td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Files Left</td><td>0</td><td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Total Files</td><td>0</td> <td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Tumour</td><td>0</td>  <td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Normal</td><td>0</td> <td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Normal</td><td>0</td> <td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Normal</td><td>0</td> <td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Normal</td><td>0</td> <td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Normal</td><td>0</td> <td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Normal</td><td>0</td> <td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Normal</td><td>0</td> <td>0</td>
					</tr>
                                        <tr>
                                                <td>Normal</td><td>0</td> <td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Normal</td><td>0</td> <td>0</td>
                                        </tr>
                                        <tr>
                                                <td>Normal</td><td>0</td> <td>0</td>
                                        </tr>
                                </tbody>

        </table>

		<div class="tabs">
			<ul class="tab-links">
				<li class="active"><a href="#tab1">Overview</a></li>
                                <li><a href="#tab2">Heidelberg</a></li>
                                <li><a href="#tab3">Cambridge</a></li>
                                <li><a href="#tab4">Hinxton</a></li>
                                <li><a href="#tab5">Toronto</a></li>
                                <li><a href="#tab6">Barcelona</a></li>
                                <li><a href="#tab7">Singapore</a></li>
                                <li><a href="#tab8">Tokyo</a></li
                                <li><a href="#tab9">Seoul</a></li>
			</ul>   
			<div class="tab-content">
				<div id="tab1" style="margin: 0px auto;position: relative; max-width: 800px;height: 900px;" class="tab active">
					<p align="center">Overview of all the locations and their current status. Enlarged view of the UK to see Cambridge and Hinxton separately.</p>
					<div id="tab1-map1" style="position: relative; width: 800px; max-height: 500px;" class="tab active"></div>
					<div id="tab1-map2" style="position: relative; max-width: 800px; max-height: 500px;" class="tab active"></div>
				</div>
<script>
	//map with all the bubbles on it
	var colors = d3.scale.category10();
	//basic map config with custom fills, mercator projection
	var pic = new Datamap({
		scope: "world",
		element: document.getElementById("tab1-map1"),
		geographyConfig: {
			popupOnHover: false,
			highlightOnHover: false,},

        projection: 'mercator',

        fills: {defaultFill: "#ABDDA4",
				red: "#FF0000",
                blue: "#63AFD0",
				yellow: "#FFFF00",
				green: "#00FF00",
				orange: "90FFFA"}
				})

	var json_data;

	d3.json("bubble_data.json", function(error, json) {
	json_data = json;
	pic.bubbles(json_data, {
		  popupTemplate: function(geo, data) {
			  return "<div class='hoverinfo'>"+data.name+"<br/>Uploaded: " + data.uploaded + " Total: " +data.total+ "</div>";
		  }
	});
	});
	
	//first zoomed in map on UK
	var zoom = new Datamap({
		element: document.getElementById("tab1-map2"),
		scope: 'world',
		geographyConfig: {
			popupOnHover: false,
			highlightOnHover: false,},
			setProjection: function(element) {
				var projection = d3.geo.mercator()
				.center([1, 52])
				.rotate([4.4, 0])
				.scale(3500)
				.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
				var path = d3.geo.path()
				.projection(projection);
				return {path: path, projection: projection};
			},
		fills: {
			defaultFill: "#ABDDA4",
			red: "#FF0000",
			blue: "#63AFD0",
			yellow: "#FFFF00",
			green: "#00FF00",
			orange: "90FFFA"}
		})
		
d3.json("frontuk.json", function(error, json) {
	json_data = json;
	zoom.bubbles(json_data, {
		  popupTemplate: function(geo, data) {
			  return "<div class='hoverinfo'>"+data.name+"<br/>Uploaded: " + data.uploaded + " Total: " +data.total+ "</div>";
		  }
	});
	});

</script>

				<div id="tab2"  style="margin:0px auto;position:relative; width: 800px; height: 500px;"class="tab">
                                        <select id="HEID" onchange = "run1()">
                                          <option value="1" selected="selected">PBCA-DE</option>
                                          <option value="2">MALY-DE</option>
                                          <option value="3">EOPC-DE</option>
                                        </select>
                                <div id="tab2a" style="margin:0px auto;position:relative; width: 800px; height: 500px;">
                                </div></div>
		 
				<div id="tab3" style="margin:0px auto;position:relative; width: 800px; height: 500px;"class="tab">
                                        <select id="CAM" onchange="run2()">
                                          <option value="1"selected="selected">ESAD-UK</option>
                                          <option value="2" >BRCA-EU</option>
                                        </select>
                                <div id="tab3a" style="margin:0px auto;position:relative; width: 800px; height: 500px;">
                                </div></div>

                                <div id="tab4" style="margin:0px auto;position:relative; width: 800px; height: 500px;"class="tab">
                                        <select id="HIN" onchange="run3()">
                                        <option value="1"selected="selected">BRCA-UK</option>
                                        <option value="2">CMDI-UK</option>
                                        <option value="3">BOCA-UK</option>
                                        <option value="4">PRAD-UK</option>
                                        </select>
                                <div id="tab4a" style="margin:0px auto;position:relative; width: 800px; height: 500px;">
                                </div></div>
					
				<div id="tab5" style="margin:0px auto;position:relative; width: 800px; height: 500px;"class="tab">
                                </div>

                                <div id="tab6" style="margin:0px auto;position:relative; width: 800px; height: 500px;"class="tab">
                                </div>

                                <div id="tab7" style="margin:0px auto;position:relative; width: 800px; height: 500px;"class="tab">
                                </div>

                                <div id="tab8" style="margin:0px auto;position:relative; width: 800px; height: 500px;"class="tab">
                                </div>

                                <div id="tab9" style="margin:0px auto;position:relative; width: 800px; height: 500px;"class="tab">
                                </div>

			</div><!--tab-content-->
		</div><!--tabs-->
	</div><!--center2-->
</div><!--fullcontain-->
<script>
	function run1() {
    var e = document.getElementById("HEID");
    var strUser = e.options[e.selectedIndex].value;
    if (strUser == "1"){
    $('#tab2a').empty();
    whole_world("tab2a","PBCA-DE_bub.json","PBCA-DE.json");
    }
    else if (strUser == "2"){
    $('#tab2a').empty();
    whole_world("tab2a","MALY-DE_bub.json","MALY-DE.json");
    }
    else if (strUser == "3"){
    $('#tab2a').empty();
    whole_world("tab2a","EOPC-DE_bub.json","EOPC-DE.json");
    }
        }
        
        function run2() {
    var e = document.getElementById("CAM");
    var strUser = e.options[e.selectedIndex].value;
    if (strUser == "1"){
    $('#tab3a').empty();
    whole_world("tab3a","ESAD-UK_bub.json","ESAD-UK.json");
    }
    else if (strUser == "2"){
    $('#tab3a').empty();
    whole_world("tab3a","BRCA-EU_bub.json","BRCA-EU.json");
    }
        }
        
        function run3() {
    var e = document.getElementById("HIN");
    var strUser = e.options[e.selectedIndex].value;
    if (strUser == "1"){
    $('#tab4a').empty();
    whole_world("tab4a","BRCA-UK_bub.json","BRCA-UK.json");
    }
    else if (strUser == "2"){
    $('#tab4a').empty();
    whole_world("tab4a","CMDI-UK_bub.json","CMDI-UK.json");
    }
    else if (strUser == "3"){
    $('#tab4a').empty();
    whole_world("tab4a","BOCA-UK_bub.json","BOCA-UK.json");
    }
    else if (strUser == "4"){
    $('#tab4a').empty();
    whole_world("tab4a","PRAD-UK_bub.json","PRAD-UK.json");
    }
        }
	
	$(document).ready(function() {
		$('.tabs .tab-links a').on('click', function(e)  {
        var currentAttrValue = $(this).attr('href');
 
        // Show/Hide Tabs
        $('.tabs ' + currentAttrValue).show().siblings().hide();

		// Picking the right tab/file to show the map
		if (currentAttrValue.slice(1) == 'tab2' ){
                $('#tab2a').empty();
                whole_world(currentAttrValue.slice(1)+'a',"PBCA-DE_bub.json","PBCA-DE.json");}
                else if (currentAttrValue.slice(1) == 'tab3'){
                $('#tab3a').empty();
                whole_world(currentAttrValue.slice(1)+'a',"ESAD-UK_bub.json","ESAD-UK.json");}
                else if (currentAttrValue.slice(1) == 'tab4'){
                $('#tab4a').empty();
                whole_world(currentAttrValue.slice(1)+'a',"BRCA-UK_bub.json","BRCA-UK.json");}
                else if (currentAttrValue.slice(1) == 'tab5'){
                $('#tab5').empty();
                whole_world(currentAttrValue.slice(1),"Toronto_bub.json","Toronto.json");}
                else if (currentAttrValue.slice(1) == 'tab6'){
                $('#tab6').empty();
                whole_world(currentAttrValue.slice(1),"Barcelona_bub.json","Barcelona.json");}
                else if (currentAttrValue.slice(1) == 'tab7'){
                $('#tab7').empty();
                whole_world(currentAttrValue.slice(1),"Singapore_bub.json","Singapore.json");}
                else if (currentAttrValue.slice(1) == 'tab8'){
                $('#tab8').empty();
                whole_world(currentAttrValue.slice(1),"Tokyo_bub.json","Tokyo.json");}
                else if (currentAttrValue.slice(1) == 'tab9'){
                $('#tab9').empty();
                whole_world(currentAttrValue.slice(1),"Seoul_bub.json","Seoul.json");}



        // Change/remove current tab to active
        $(this).parent('li').addClass('active').siblings().removeClass('active');
 
        e.preventDefault();        
   });
});
</script>
<img src="http://marsinnovation.com/wp-content/uploads/2012/06/OICR-logo-1024x742.jpeg" class="ribbon" width="200" height="150"/>
</body>
</html>
